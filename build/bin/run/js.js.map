{"version":3,"sources":["../../../src/bin/run/js.js"],"names":["runJs","source","output","console","log","process","exit","s","rs","pipe","c","Catchment","res","promise","ws","Promise","r","j","on","end","err"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA;;;;AAIe,eAAeA,KAAf,CAAqB;AAClCC,QADkC;AAElCC,WAASD;AAFyB,CAArB,EAGZ;AACD,MAAI;AACF,QAAI,CAACA,MAAL,EAAa;AACXE,cAAQC,GAAR,CAAY,mCAAZ;AACAC,cAAQC,IAAR,CAAa,CAAb;AACD;;AAED,UAAMC,IAAI,0BAAiBN,MAAjB,CAAV;AACA,UAAMO,KAAK,+BAAX;AACAD,MAAEE,IAAF,CAAOD,EAAP;AACA,UAAME,IAAI,IAAIC,kBAAJ,CAAc;AACtBH;AADsB,KAAd,CAAV;AAGA,UAAMI,MAAM,MAAMF,EAAEG,OAApB;AACA,UAAMC,KAAK,2BAAkBZ,MAAlB,CAAX;AACA,UAAM,IAAIa,OAAJ,CAAY,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC1BH,SAAGI,EAAH,CAAM,OAAN,EAAeD,CAAf,EAAkBE,GAAlB,CAAsBP,GAAtB,EAA2BI,CAA3B;AACD,KAFK,CAAN;AAGAb,YAAQC,GAAR,CAAY,IAAIH,UAAUC,MAAV,GAAmB,CAAC,8BAAD,EAAiCD,MAAjC,CAAnB,GAA8D,CAAC,oBAAD,EAAuBC,MAAvB,CAAlE,CAAZ;AACD,GAlBD,CAkBE,OAAOkB,GAAP,EAAY;AACZ,0BAAQA,GAAR;AACD;AACF","sourcesContent":["import { createWriteStream, createReadStream } from 'fs'\nimport Catchment from 'catchment'\nimport createJsReplaceStream from '../../lib/js-replace-stream'\nimport catcher from '../catcher'\n\n/**\n * Process a JavaScript file.\n * @param {string} source Path to the source JavaScript file.\n */\nexport default async function runJs({\n  source,\n  output = source,\n}) {\n  try {\n    if (!source) {\n      console.log('Please specify a JavaScript file.')\n      process.exit(1)\n    }\n\n    const s = createReadStream(source)\n    const rs = createJsReplaceStream()\n    s.pipe(rs)\n    const c = new Catchment({\n      rs,\n    })\n    const res = await c.promise\n    const ws = createWriteStream(output)\n    await new Promise((r, j) => {\n      ws.on('error', j).end(res, r)\n    })\n    console.log(...(source == output ? ['Updated %s to include types.', source] : ['Saved output to %s', output]))\n  } catch (err) {\n    catcher(err)\n  }\n}\n"],"file":"js.js"}