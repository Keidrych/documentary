{"version":3,"sources":["../../../src/lib/rules/fork.js"],"names":[],"mappings":"AAAA,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,YAAY;AAClC,MAAM,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;;;;AAKhC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;EACf,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACpC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IACrC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAClC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;MAClC,QAAQ,CAAC,CAAC,CAAC,CAAC;MACZ,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;IACf,CAAC;IACD,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;IACjC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;IAC3B,MAAM,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI;EACtC,CAAC;AACH;;;AAGA,MAAM,CAAC,OAAO,CAAC","file":"lib/rules/fork.js","sourcesContent":["import { fork } from 'spawncommand'\nimport { codeSurround } from '..'\n// import { debuglog } from 'util'\n\n// const LOG = debuglog('doc')\n\nconst forkRule = {\n  re: /%FORK(ERR)?(?:-(\\w+))? (.+)%/mg,\n  async replacement(match, err, lang, m) {\n    const [mod, ...args] = m.split(' ')\n    const { promise } = fork(mod, args, {\n      execArgv: [],\n      stdio: 'pipe',\n    })\n    const { stdout, stderr } = await promise\n    const res = err ? stderr : stdout\n    return codeSurround(res.trim(), lang)\n  },\n}\n\n\nexport default forkRule\n"]}