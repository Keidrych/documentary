{"version":3,"sources":["../../../src/lib/rules/fork.js"],"names":["forkRule","re","replacement","match","lang","m","mod","args","split","f","execArgv","stdio","stdout","promise","codeSurround","trim"],"mappings":";;;;;;;AAAA;;AACA;AAEA;AAEA,MAAMA,WAAW;AACfC,MAAI,0BADW;;AAEf,QAAMC,WAAN,CAAkBC,KAAlB,EAAyBC,IAAzB,EAA+BC,CAA/B,EAAkC;AAChC,UAAM,CAACC,GAAD,EAAM,GAAGC,IAAT,IAAiBF,EAAEG,KAAF,CAAQ,GAAR,CAAvB;AACA,UAAMC,IAAI,wBAAKH,GAAL,EAAUC,IAAV,EAAgB;AACxBG,gBAAU,EADc;AAExBC,aAAO;AAFiB,KAAhB,CAAV;AAIA,UAAM;AAAEC;AAAF,QAAa,MAAMH,EAAEI,OAA3B;AACA,WAAOC,aAAaF,MAAb,EAAqBR,IAArB,CAAP;AACD;;AAVc,CAAjB;;AAaA,MAAMU,eAAe,CAACT,CAAD,EAAID,OAAO,EAAX,KAAmB,SAAQA,IAAK,KAAIC,EAAEU,IAAF,EAAS,UAAlE;;eAEef,Q","sourcesContent":["import { fork } from 'spawncommand'\n// import { debuglog } from 'util'\n\n// const LOG = debuglog('doc')\n\nconst forkRule = {\n  re: /%FORK(?:-(\\w+))? (.+)%/mg,\n  async replacement(match, lang, m) {\n    const [mod, ...args] = m.split(' ')\n    const f = fork(mod, args, {\n      execArgv: [],\n      stdio: 'pipe',\n    })\n    const { stdout } = await f.promise\n    return codeSurround(stdout, lang)\n  },\n}\n\nconst codeSurround = (m, lang = '') => `\\`\\`\\`${lang}\\n${m.trim()}\\n\\`\\`\\``\n\nexport default forkRule\n"],"file":"fork.js"}