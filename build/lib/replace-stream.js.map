{"version":3,"sources":["../../src/lib/replace-stream.js"],"names":["createReplaceStream","toc","tocRule","codeBlocks","marker","Date","now","s","Replaceable","commentRule","re","RegExp","codeRe","replacement","match","exactTable","test","exactMethodTitle","push","badgeRule","tableRule","titleRule","exampleRule","shift"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEe,SAASA,mBAAT,CAA6BC,GAA7B,EAAkC;AAC/C,QAAMC,UAAU,0BAAcD,GAAd,CAAhB;AAEA,QAAME,aAAa,EAAnB;AACA,QAAMC,SAAU,8BAA6BC,KAAKC,GAAL,EAAW,KAAxD;AACA,QAAMC,IAAI,IAAIC,qBAAJ,CAAgB,CACxBC,kBADwB,EAExB;AACEC,QAAI,IAAIC,MAAJ,CAAWC,aAAX,EAAmB,GAAnB,CADN;;AAEEC,gBAAYC,KAAZ,EAAmB;AACjB,UAAIC,gBAAWC,IAAX,CAAgBF,KAAhB,KAA0BG,sBAAiBD,IAAjB,CAAsBF,KAAtB,CAA9B,EAA4D;AAC1D,eAAOA,KAAP;AACD;;AACDX,iBAAWe,IAAX,CAAgBJ,KAAhB;AACA,aAAOV,MAAP;AACD;;AARH,GAFwB,EAYxBF,OAZwB,EAaxBiB,gBAbwB,EAcxBC,cAdwB,EAexBC,oBAfwB,EAgBxBC,gBAhBwB,EAiBxB;AACEZ,QAAI,IAAIC,MAAJ,CAAWP,MAAX,EAAmB,GAAnB,CADN;;AAEES,kBAAc;AACZ,aAAOV,WAAWoB,KAAX,EAAP;AACD;;AAJH,GAjBwB,CAAhB,CAAV;AAyBA,SAAOhB,CAAP;AACD","sourcesContent":["import { Replaceable } from 'restream'\nimport { badgeRule, createTocRule, commentRule, codeRe } from './rules'\nimport { exactTable, exactMethodTitle } from '../lib'\nimport tableRule from './rules/table'\nimport titleRule from './rules/method-title'\nimport exampleRule from './rules/example'\n\nexport default function createReplaceStream(toc) {\n  const tocRule = createTocRule(toc)\n\n  const codeBlocks = []\n  const marker = `%%_DOCUMENTARY_REPLACEMENT_${Date.now()}_%%`\n  const s = new Replaceable([\n    commentRule,\n    {\n      re: new RegExp(codeRe, 'g'),\n      replacement(match) {\n        if (exactTable.test(match) || exactMethodTitle.test(match)) {\n          return match\n        }\n        codeBlocks.push(match)\n        return marker\n      },\n    },\n    tocRule,\n    badgeRule,\n    tableRule,\n    titleRule,\n    exampleRule,\n    {\n      re: new RegExp(marker, 'g'),\n      replacement() {\n        return codeBlocks.shift()\n      },\n    },\n  ])\n\n  return s\n}\n"],"file":"replace-stream.js"}